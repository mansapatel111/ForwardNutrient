<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutrientForward</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Agrandir:wght@400;700&display=swap');

        body {
            font-family: 'Agrandir', sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            background-image: url('static/images/Nutrient_Forward.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            color: #abd7ff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }


        .hidden {
            display: none;
        }

        #page0,
        #page1,
        #page2,
        #page3,
        #page4 {
            text-align: center;
        }


        #page0 {
            cursor: pointer;
        }

        #page0 h1 {
            font-size: 67px;
            margin: 0;
        }


        .centered-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .centered-content-result {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 35px;
        }

        select,
        button {
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        select {
            background-color: rgba(255, 255, 255, 0.9);
            color: #203162;
        }

        button {
            padding: 10px 20px;
            font-size:17px;
            font-style: bold;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            background-color:  #abd7ff;
            color: #203162;
            width: 150px;
            text-align: center;
        }

        button:hover {
            background-color: #ffc610; /* #4672f4 */
        }

        h2 {
            font-size: 48px;
            margin-bottom: 20px;
        }
        h3 {
            font-size: 28px;
            color: white;
            margin-bottom: 20px;
        }
        /* Table styling here below */
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }

        th {
            background-color: #007BFF;
            color: white;
            text-align: left;
        }

        /* tr:nth-child(even) {
            background-color: #f2f2f2;
        } */

        /* tr:hover {
            background-color: #ddd;
        } */

        td.centered {
            text-align: center;
            font-style: bold;
        }
    </style>
</head>

<body>
    <!-- First Page: Title in the Center -->
    <div id="page0" onclick="goToPage(1)">
        <h1>Nutrient Forward</h1>
    </div>

    <!-- Page 1: Select a Restaurant -->
    <div id="page1" class="hidden">
        <div class="centered-content">
            <h2>Choose a restaurant</h2>
            <select id="restaurant">
                <option value="">Select a Restaurant</option>
                <option value="Applebee's">Applebee's</option>
                <option value="Arby's">Arby's</option>
                <option value="Auntie Anne's">Auntie Anne's</option>
                <option value="Baskin Robbins">Baskin Robbins</option>
                <option value="Big Boy/Frisch's Big Boy">Big Boy/Frisch's Big Boy</option>
                <option value="BJ's Restaurant & Brewhouse">BJ's Restaurant & Brewhouse</option>
                <option value="Bob Evans">Bob Evans</option>
                <option value="Bojangles">Bojangles</option>
                <option value="Bonefish Grill">Bonefish Grill</option>
                <option value="Buffalo Wild Wings">Buffalo Wild Wings</option>
                <option value="Burger King">Burger King</option>
                <option value="California Pizza Kitchen">California Pizza Kitchen</option>
                <option value="Captain D's">Captain D's</option>
                <option value="Carls Jr">Carls Jr</option>
                <option value="Carrabba's Italian Grill">Carrabba's Italian Grill</option>
                <option value="Casey's General Store">Casey's General Store</option>
                <option value="Checker's Drive-In/ Rally's">Checker's Drive-In/ Rally's</option>
                <option value="Cheddar's Casual Café / Cheddar's Scratch Kitchen">Cheddar's Casual Café / Cheddar's Scratch Kitchen</option>
                <option value="Chick Fil A">Chick Fil A</option>
                <option value="Chili's">Chili's</option>
                <option value="Chipotle">Chipotle</option>
                <option value="Chuck E. Cheese">Chuck E. Cheese</option>
                <option value="Church's Chicken">Church's Chicken</option>
                <option value="Ci Ci's">Ci Ci's</option>
                <option value="Cracker Barrel">Cracker Barrel</option>
                <option value="Culver's">Culver's</option>
                <option value="Dairy Queen">Dairy Queen</option>
                <option value="Del Taco">Del Taco</option>
                <option value="Denny's">Denny's</option>
                <option value="Dickey's Barbeque">Dickey's Barbeque</option>
                <option value="Domino's">Domino's</option>
                <option value="Dunkin' Donuts">Dunkin' Donuts</option>
                <option value="Einstein Bros">Einstein Bros</option>
                <option value="El Pollo Loco">El Pollo Loco</option>
                <option value="Famous Dave's">Famous Dave's</option>
                <option value="Firehouse Subs">Firehouse Subs</option>
                <option value="Five Guys">Five Guys</option>
                <option value="Golden Corral">Golden Corral</option>
                <option value="Hardee's">Hardee's</option>
                <option value="Hooter's">Hooter's</option>
                <option value="IHOP">IHOP</option>
                <option value="In-N-Out">In-N-Out</option>
                <option value="Jack in the Box">Jack in the Box</option>
                <option value="Jamba Juice">Jamba Juice</option>
                <option value="Jimmy John's">Jimmy John's</option>
                <option value="Joe's Crab Shack">Joe's Crab Shack</option>
                <option value="KFC">KFC</option>
                <option value="Krispy Kreme">Krispy Kreme</option>
                <option value="Krystal">Krystal</option>
                <option value="Little Caesar's">Little Caesar's</option>
                <option value="Long John Silver's">Long John Silver's</option>
                <option value="Longhorn Steakhouse">Longhorn Steakhouse</option>
                <option value="McDonald's">McDonald's</option>
                <option value="Moe's Southwest Grill">Moe's Southwest Grill</option>
                <option value="O'Charley's">O'Charley's</option>
                <option value="Olive Garden">Olive Garden</option>
                <option value="On The Border">On The Border</option>
                <option value="Outback Steakhouse">Outback Steakhouse</option>
                <option value="Panda Express">Panda Express</option>
                <option value="Panera Bread">Panera Bread</option>
                <option value="Papa John's">Papa John's</option>
                <option value="Papa Murphy's">Papa Murphy's</option>
                <option value="Perkins">Perkins</option>
                <option value="PF Chang's">PF Chang's</option>
                <option value="Pizza Hut">Pizza Hut</option>
                <option value="Popeyes">Popeyes</option>
                <option value="Portillo's">Portillo's</option>
                <option value="Qdoba">Qdoba</option>
                <option value="Quiznos">Quiznos</option>
                <option value="Raising Cane's Chicken Fingers">Raising Cane's Chicken Fingers</option>
                <option value="Red Lobster">Red Lobster</option>
                <option value="Red Robin">Red Robin</option>
                <option value="Romano's Macaroni & Grill">Romano's Macaroni & Grill</option>
                <option value="Round Table Pizza">Round Table Pizza</option>
                <option value="Sbarro">Sbarro</option>
                <option value="Shake Shack">Shake Shack</option>
                <option value="Sonic">Sonic</option>
                <option value="Starbucks">Starbucks</option>
                <option value="Steak 'N Shake">Steak 'N Shake</option>
                <option value="Subway">Subway</option>
                <option value="Taco Bell">Taco Bell</option>
                <option value="TGI Friday's">TGI Friday's</option>
                <option value="The Capital Grille">The Capital Grille</option>
                <option value="The Cheesecake Factory">The Cheesecake Factory</option>
                <option value="Tropical Smoothie Café">Tropical Smoothie Café</option>
                <option value="Waffle House">Waffle House</option>
                <option value="Wendy's">Wendy's</option>
                <option value="Whataburger">Whataburger</option>
                <option value="White Castle">White Castle</option>
                <option value="Wingstop">Wingstop</option>
                <option value="Yard House">Yard House</option>
                <option value="Zaxby's">Zaxby's</option>
            </select>
            <button onclick="setRestaurant()">Next</button>
        </div>
    </div>

    <!-- Page 2: Select a Food Category -->
    <div id="page2" class="hidden">
        <div class="centered-content">
            <h2>Choose a Food Category</h2>
            <button onclick="setCategory('Appetizers & Sides')">Appetizers</button>
            <button onclick="setCategory('Entrees')">Entrees</button>
            <button onclick="setCategory('Salads')">Salads</button>
            <button onclick="setCategory('Sandwiches')">Sandwiches</button>
            <button onclick="setCategory('Soup')">Soups</button>
            <button onclick="setCategory('Fried Potatoes')">Fries</button>
            <button onclick="setCategory('Burgers')">Burgers</button>
            <button onclick="setCategory('Pizza')">Pizza</button>
            <button onclick="setCategory('Desserts')">Desserts</button>
            <button onclick="setCategory('Baked Goods')">Baked Goods</button>
            <button onclick="setCategory('Beverages')">Beverages</button>
            <button onclick="setCategory('Toppings & Ingredients')">Toppings</button>
        </div>
    </div>

    <!-- Page 3: Sorting Options -->
    <div id="page3" class="hidden">
        <div class="centered-content">
            <h2>What's Important To You ?</h2>
            <button onclick="setCriteria('calories')">Calories</button>
            <button onclick="setCriteria('protein')">Protein</button>
            <button onclick="setCriteria('total_fat')">Fat</button>
            <button onclick="setCriteria('cholesterol')">Cholesterol</button>
            <button onclick="setCriteria('sodium')">Sodium</button>
            <button onclick="setCriteria('carbohydrates')">Carbs</button>
            <button onclick="setCriteria('dietary_fiber')">Fiber</button>
            <button onclick="setCriteria('sugar')">Sugar</button>
        </div>
    </div>
    <!-- Page 4: Choose Your Level -->
    <div id="page4" class="hidden">
        <div class="centered-content">
            <h2>Choose your desired level:</h2>
            <div style="display: flex; gap: 20px; justify-content: center;">
                <button onclick="setLevel('High')">High</button>
                <!-- <button onclick="setLevel('Medium')">Medium (15 - 30g)</button> -->
                <button onclick="setLevel('Low')">Low </button>
            </div>
        </div>
    </div>
    <!-- Page 5: Choose Your Sort -->
    <div id="page5" class="hidden">
        <div class="centered-content">
            <h2>Choose your sorting method:</h2>
            <div style="display: flex; gap: 20px; justify-content: center;">
                <button onclick="setSort('Merge')">Merge Sort</button>
                <button onclick="setSort('Quick')">Quick Sort</button>
            </div>
        </div>
    </div>
    <!-- Page 6: Display Results -->
    <div id="page6" class="hidden">
        <div class="centered-content-result">
            <h2>Results using <span id ="selectedSort"></span> sort</h2>
            <h3><span id="selectedLevel"></span> <span id="selectedCriteria"></span> <span id="selectedCategory"></span> at <span id="selectedRestaurant"></span> </h3>
            <table>
                <thead>
                    <tr>
                        <th>Food Item</th>
                        <th>Calories</th>
                        <th>Fat (g)</th>
                        <th>Cholestrol (mg)</th>
                        <th>Sodium (mg)</th>
                        <th>Carbs (g)</th>
                        <th>Fiber (g)</th>
                        <th>Sugar (g)</th>
                        <th>Protein (g)</th>
                    </tr>
                </thead>
                <tbody id="resultsTable">
                    <!-- Data should hopefully be dynamically inserted here -->
                    <tr>
                        <td class="centered">${itemName}</td>
                        <td class="centered">${value_calories}</td>
                        <td class="centered">${value_fat}</td>
                        <td class="centered">${value_cholestrol}</td>
                        <td class="centered">${value_sodium}</td>
                        <td class="centered">${value_carbs}</td>
                        <td class="centered">${value_fiber}</td>
                        <td class="centered">${value_sugar}</td>
                        <td class="centered">${value_protein}</td>
                    </tr>
                </tbody>
            </table>
            <button onclick="restart()">Start Over</button>
        </div>
    </div>











    <script>
        let selectedRestaurant = '';
        let selectedCategory = '';
        let selectedCriteria = '';
        let selectedLevel = '';
        let selectedSort = '';
    
        function goToPage(pageNumber) {
            document.querySelectorAll('div[id^="page"]').forEach(page => {
                page.classList.add('hidden');
            });
            document.getElementById(`page${pageNumber}`).classList.remove('hidden');
            if (pageNumber === 6) {
                updateResultsTitle();
            }
        }
        

        function setRestaurant() {
            
            selectedRestaurant = document.getElementById('restaurant').value;
            if (!selectedRestaurant) {
                alert('Please select a restaurant!');
            return;
            }
            console.log('Selected restaurant:', selectedRestaurant);

            goToPage(2);
        }

    
        function setCategory(category) {
            selectedCategory = category;
            console.log(`Selected Category: ${category}`);
            goToPage(3);
        }
    
        function setCriteria(criteria) {
            selectedCriteria = criteria;
            console.log(`Selected Criteria: ${criteria}`);
            goToPage(4);
        }
        
        


        function setLevel(level) {
            selectedLevel = level;
            console.log(`Selected Level: ${level}`);
        

           goToPage(5);
            
        }
        
        function setSort(sorting) {
            selectedSort = sorting;
            console.log(`Selected Sort: ${sorting}`);
        
            
            fetchSortedData(selectedRestaurant, selectedCategory, selectedCriteria, selectedLevel, selectedSort);

            
        }

        function updateResultsTitle() {
            document.getElementById('selectedLevel').textContent = selectedLevel;
            document.getElementById('selectedCriteria').textContent = selectedCriteria;
            document.getElementById('selectedCategory').textContent = selectedCategory;
            document.getElementById('selectedRestaurant').textContent = selectedRestaurant;
            document.getElementById('selectedSort').textContent = selectedSort;
        }
        function fetchSortedData(restaurant, category, criteria, level, sorting) {
            console.log('Sending request with data:', { restaurant, category, criteria, level, sorting });

            fetch('http://127.0.0.1:5000/sort', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ restaurant, category, criteria, level, sorting })
            })
            .then(response => response.json())
            .then(data => {
                console.log('Response data:', data);
                populateResultsTable(data);
                goToPage(6);
            })
            .catch(error => {
                console.error('Error fetching sorted data:', error);
                alert('An error occurred while fetching data. Please try again.');
            });
        }

        
        function populateResultsTable(data) {

            console.log("Data received:", data); // Debugging the data format
           

            const resultsTable = document.getElementById('resultsTable');
            if (!resultsTable) {
                console.error("Error: Unable to find the table element with ID 'resultsTable'");
                return;
            }

            resultsTable.innerHTML = ''; // Clear previous results

        

            if(data === "error: category not found"){
                resultsTable.innerHTML = `<tr><td colspan="2" style="color: red; font-size: 1em;"> Oops! Your food category was not found in the dataset, Try a different Category!</td></tr>`;
                return;
            }else if(data === "error: crirteria not found in restaurant"){
                resultsTable.innerHTML = `<tr><td colspan="2" style="color: red; font-size: 1em;"> Sorry! We dont have data for this crirteria at this restaurant, Try a different crirteria!</td></tr>`;
                return;
            }else if (data.length === 0){
                resultsTable.innerHTML = `<tr><td colspan="2">No results found</td></tr>`;
                return;
            }

            // Using a for loop instead of forEach
            for (let i = 0; i < data.length; i++) {

                if (i % 9 == 0 ){
                    const itemName = data[i];
                    const value_calories = data[i + 1];
                    
                    const value_fat = data[i + 2];
                    const value_cholestrol = data[i + 3];
                    const value_sodium = data[i + 4];
                    const value_carbs = data[i + 5];
                    const value_fiber = data[i + 6];
                    const value_sugar = data[i + 7];
                    const value_protein = data[i + 8];

                    // Create a new table row
                    const row = document.createElement('tr');
                    row.innerHTML = `
                       
                        <td> ${itemName}</td>
                        <td> ${value_calories}</td>
    
                        <td>${value_fat}</td>
                        <td>${value_cholestrol}</td>
                        <td>${value_sodium}</td>
                        <td>${value_carbs}</td>
                        <td>${value_fiber}</td>
                        <td>${value_sugar}</td>
                        <td>${value_protein}</td>
                    `;
                    resultsTable.appendChild(row);
                    }
                else {
                    continue;
                }

               
                     
            }
        }
        function restart() {
            selectedRestaurant = '';
            selectedCategory = '';
            selectedCriteria = '';
            selectedLevel = '';
        
            goToPage(1);
        }
    </script>
    </body>
</html>
   
